// Generated by CoffeeScript 2.5.1
var session;

session = require('../session');

module.exports = {
  name: '@nikitajs/core/lib/plugins/execute',
  require: ['@nikitajs/core/lib/metadata/raw', '@nikitajs/core/lib/metadata/disabled'],
  hooks: {
    'nikita:action': {
      after: '@nikitajs/core/lib/plugins/tools_find',
      handler: async function(action) {
        if (action.metadata.namespace.join('.') !== 'execute') {
          return;
        }
        // bash = await find ({metadata: {bash}}) -> bash
        if (config.arch_chroot == null) {
          config.arch_chroot = (await find(function({
              metadata: {arch_chroot}
            }) {
            return arch_chroot;
          }));
        }
        if (config.dry == null) {
          config.dry = (await find(function({
              metadata: {dry}
            }) {
            return dry;
          }));
        }
        return config.sudo != null ? config.sudo : config.sudo = (await find(function({
            metadata: {sudo}
          }) {
          return sudo;
        }));
      }
    }
  }
};
