// Generated by CoffeeScript 2.5.1
var os, path;

os = require('os');

path = require('path');

module.exports = function(action) {
  return {
    module: '@nikitajs/engine/src/plugins/operation_path',
    require: '@nikitajs/engine/src/metadata/ssh',
    hooks: {
      'nikita:session:action': {
        // after: '@nikitajs/engine/src/metadata/ssh'
        handler: function(action, handler) {
          if (action.operations == null) {
            action.operations = {};
          }
          // Path is alwaws posix over ssh
          // otherwise it is platform dependent
          action.operations.path = !action.ssh ? os.platform === 'win32' ? path.win32 : path.posix : path.posix;
          // Reinject posix and win32 path for conveniency
          action.operations.path.posix = path.posix;
          action.operations.path.win32 = path.win32;
          return handler;
        }
      }
    }
  };
};
