// Generated by CoffeeScript 2.5.1
/*
Return events emitted inside the action

*/
module.exports = function() {
  return {
    module: '@nikitajs/engine/src/plugins/output_events',
    require: ['@nikitajs/engine/src/plugins/log', '@nikitajs/engine/src/metadata/status'],
    hooks: {
      'nikita:session:action': {
        after: '@nikitajs/engine/src/plugins/log',
        handler: function(action) {
          action.logs = [];
          return action.log = (function(log) {
            return function(info) {
              action.logs.push(info);
              return log.call(null, info);
            };
          })(action.log);
        }
      },
      'nikita:session:result': {
        after: '@nikitajs/engine/src/metadata/status',
        handler: function({action, output}, handler) {
          return async function({action}) {
            output = (await handler.apply(null, arguments));
            output.logs = action.logs;
            return output;
          };
        }
      }
    }
  };
};
